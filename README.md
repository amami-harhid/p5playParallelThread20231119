# p5playParallelThread20231119
p5play Sprite にて Scratch3 風に 繰り返し処理を書きたい！を目指すものです

## Javascriptでの問題点

Javascript で次のようなコードを書くと ブラウザーが固まってしまします。

```
const _f = (_count)=>{
  for(;;) {
    // p5.play のプロパティ操作などのコードを書く。
    // 例えば x,y 座標をインクリメントするとか。
  }
}
_f();
```
## p5 推奨風の書き方

これを p5 で実現するならば次のようにするのが p5の推奨です（だよね？）。

```: コード
draw() {
  // p5.play のプロパティ操作などのコードを書く。
  // 例えば x,y 座標をインクリメントするとか。
}

```

## 寂しさ
p5推奨のやり方では、for(;;) や while(true) を書かないので（直接見えないので）、僕は無限ループだよ！と強く主張できないのが寂しいです。

## ややこしさ
無限ループだけならいいですが、ループの中に入れ子で 回数分の繰り返し、条件分岐を入れる、入れ子の入れ子などを p5 推奨風に実現するのは、実装がややこしくなってしまいます（ような気がします）。

## Scratch3 みたいにコードを書きたい
比べることに無理があるのは承知の上ですが、Scratch3 では わかりやすく Loop をかけます。
たくさんスクリプトを書いて、それぞれのスクリプトが並列風に動きますよね。
Scratch3では、ここは 永久フープだ！、そのなかで条件分岐コードがあって、その下に 回数繰り返し処理があって・・とコードがとても見やすいのです。

## そこで

p5.play のスプライトの中で、こんな風にコードを書きたい！　を目指します。
繰り返し処理の中が見通しがよくなるので コードを書きやすい！読みやすい！が狙いです。

### 永久ループ 
```
C.LoopForEver(async _=> {　// <--- for(;;) を意味する行

});
```
### 指定した回数分の繰り返し

```
// 10回の繰り返し
C.LoopRepeat(10, async _=> { // <--- for(let i=0; i<10; i++) を意味する行

});
```
### 入れ子の組み合わせも大丈夫にしたい

繰り返しの入れ子もがんがんとつかいたい。

```
let _counter = 0;
C.LoopForEver(async _=> {  // <--- for(;;) を意味する行
  this.x += 5; // スプライトのx座標を +5 する
  _counter += 1;
  if (_counter == 100) {
    this.x = 0;
  }
  // 10回の繰り返し
  await C.LoopRepeat(10, async _=> { // <--- for(let i=0; i<10; i++) を意味する行
    this.y += 10;
    // 30回の繰り返し
    await C.LoopRepeat(30, async _=> { // <--- for(let i=0; i<30; i++) を意味する行
      this.rotation += 10;
    });  
  });
});
```

お気づきかと思いますが、async / await を利用して実現しています。

## お詫び

まだトライアル版なので、LoopForEver と LoopRepeat の２種類しか用意していません。
今後追加しますが、ひとまず レポジトリを作ったものです。

## 使い方
これを スクリプトタグに追加
```
<script src="https://amami-harhid.github.io/p5playParallelThread20231119/js/ParallelThreadSupport.js"></script>
```

利用方法は、js/Pico.js をみてね。
